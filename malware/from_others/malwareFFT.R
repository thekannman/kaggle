
# read in training labels
trainLabels=read.table(file="trainLabels.csv", sep=",", header=T)

# read in training data
train.filenames <- list.files("train", pattern="*.bytes", full.names=TRUE)
noTrain = length(train.filenames)

# variable to break the job into blocks
progressBlock=1000

# variable to set the width of FFT analysis to keep
FFTWidth=1000

# create empty matrix to contain results
myFFT=matrix(,nrow=noTrain,ncol=2*FFTWidth)
# label the matrix using the base part of the filenames
row.names(myFFT)=substr(train.filenames,7,26)

for (i in 1:noTrain) {
    print(train.filenames[i])

    # take FFT of the decimal values of the hex values in the .bytes file with 1st column (labels) removed
    thisFFT=fft(as.numeric(sprintf("%d",unlist(read.table(train.filenames[i])[,2:17], use.names=FALSE))))[1:FFTWidth]

     # separate out the resulting complex numbers into amplitude and phase parts and store them separately
    myFFT[i,1:FFTWidth]=Mod(thisFFT)
    myFFT[i,(FFTWidth+1):(2*FFTWidth)]=Arg(thisFFT)

    # check on progress and dump results so far if it's warranted
    if ((i %% progressBlock) == 0) {
      print(i)
      # write out a copy of the results so we can restart if it crashes
      write.table(myFFT,file="FFTResults.txt",sep='\t',row.names=TRUE)
    }
}
# dump final results
write.table(myFFT,file="FFTResults.txt",sep='\t',row.names=TRUE)

